CREATE OR REPLACE PROCEDURE public.get_approvalstatus(
	_actionby text,
	_flowname text,
	INOUT _result_one refcursor DEFAULT 'rs_approvaldata'::refcursor)
LANGUAGE 'plpgsql'
AS $BODY$

BEGIN

  open _result_one for 
  SELECT "approvalEngUniqueID", status, "approvalReason", "rejectionReason", description, justification, remarks, comments, "latestUpdateDate", flow_id, "isDeleted"
        FROM public."ApprovalEngMasterData" 
        WHERE "flow_id" = (
            SELECT f."approvalFlowId"
            FROM public."ApprovalFlow" f
            WHERE f."approvalFlowName" = _flowName
        ) AND
        (LOWER("status"::text) LIKE LOWER(_actionby) OR UPPER("status"::text) LIKE UPPER(_actionby));

END;
$BODY$;
